# Building workflow for Alpine.
#
# 1. Use this docker file to build the executable.
#    docker build -t scr_alpine -f Dockerfile_Alpine ./
#
# 2. Run the built image.
#    docker run scr_alpine
#
# 3. Check the created container id.
#    docker ps -a
#
# 4. Use "docker cp" to get the built executable.
#    docker cp <CONTAINER ID>:/Simple-Command-Runner/build/Release/SimpleCommandRunner ./
#
# Note: You can also use buildx for cross compiling
#    sudo apt install -y qemu-user-static binfmt-support
#    docker buildx build --platform linux/arm64 -t scr_alpine_arm -f Dockerfile_Alpine ./

# Base image
FROM alpine:3.16.5

# Install packages
RUN apk update && \
    apk add --no-cache \
        alpine-sdk linux-headers bash gtk+3.0-dev \
        py3-pip python3

# Install meson
RUN pip3 install meson ninja

# Clone the repo
WORKDIR /
RUN git clone -b libui --depth 1 https://github.com/matyalatte/Simple-Command-Runner.git

# Build
WORKDIR /Simple-Command-Runner/shell_scripts
RUN bash build.sh
